---
title: "Modules and Imports"
description: "Organize DOL specifications into reusable modules"
lesson: 8
track: "dol-fundamentals"
duration: "15 minutes"
concepts: ["module", "use", "pub", "requires", "versioning", "systems"]
prev: "/dol/tutorials/007-error-handling"
next: null
---

# Modules and Imports

As your DOL specifications grow, you need to organize them into modules. Modules help you group related declarations, control visibility, and manage dependencies.

## Module Declaration

Every DOL file can declare its module with a version. DOL v0.3.0 prefers `mod` over `module`:

```dol
mod dol.token @ 0.4.0

docs {
  Token span tracks the location of tokens in source code.
}

/// Source location information
pub gen Span {
  has start: u32
  has end: u32
  has file_id: u32
}
```

The module declaration includes:
- `mod` - keyword (also accepts `module` for compatibility)
- `dol.token` - module path using dot notation
- `@` - version separator
- `0.4.0` - semver version number

## Import Syntax

Use the `use` statement to import from other modules:

```dol
mod dol.ast @ 0.4.0

use dol.token.{ Span }
use dol.types.{ TypeExpr, TypeParam }

pub gen GeneDecl {
  has name: string
  has type_params<Vec<TypeParam>
  has fields<Vec<Field>
  has span: Span

  docs {
    A gen declaration with type parameters and fields.
    Imports Span from dol.token module.
  }
}
```

### Import Patterns

```dol
// Import single item
use dol.token.{ Span }

// Import multiple items
use dol.types.{ TypeExpr, TypeParam, Field }

// Import with alias
use dol.token.{ Span as SourceSpan }

// Import all public items
use dol.ast.{ * }
```

## Public vs Private

Items are private by default. Use `pub` to make them public:

```dol
mod user.account @ 1.0.0

// Public - accessible from other modules
pub gen User {
  has id: u64
  has name: string
  has email: string
  has password_hash: string  // Private field within public gene

  docs {
    A user account in the system.
  }
}

// Private - only accessible within this module
gen InternalCache {
  has entries: Map<u64, User>

  docs {
    Internal caching mechanism, not exposed.
  }
}

// Public function
pub fun create_user(name: string, email: string) -> User {
  // implementation
}

// Private function
fun hash_password(password: string) -> string {
  // internal implementation
}
```

## Systems and Dependencies

Systems declare external dependencies with `requires`:

```dol
system greeting.service @0.1.0 {
  requires entity.greetable >= 0.0.1
  requires greeting.protocol >= 0.0.1

  uses hello.world

  service has greeting.templates
  service has message.history
}

docs {
  The greeting service orchestrates salutations across the Univrs platform.
  It depends on the greetable trait (any entity that can receive greetings)
  and the greeting protocol (standard formats and delivery mechanisms).
  The service uses the hello.world gen for basic message structure.

  Templates provide customizable greeting formats. History maintains
  an audit trail of all greetings sent, enabling replay and analysis.
}
```

### Dependency Constraints

```dol
system mycelium.network @0.2.0 {
  // Exact version
  requires transport.protocol = 0.1.0

  // Minimum version
  requires nutrient.model >= 0.0.1

  // Version range
  requires spatial.coords >= 0.1.0, < 1.0.0

  uses MyceliumNode
  uses HyphalSegment
}

docs {
  Mycelium network with versioned dependencies.
}
```

## Module Organization

A typical DOL project structure:

```
my-project/
├── dol.toml              # Project manifest
├── src/
│   ├── lib.dol           # Library entry point
│   ├── types/
│   │   ├── mod.dol       # Types module
│   │   ├── core.dol      # Core types
│   │   └── errors.dol    # Error types
│   ├── traits/
│   │   ├── mod.dol       # Traits module
│   │   └── lifecycle.dol # Lifecycle traits
│   └── systems/
│       ├── mod.dol       # Systems module
│       └── network.dol   # Network system
└── examples/
    └── demo.dol          # Example usage
```

### lib.dol (Entry Point)

```dol
mod myproject @ 1.0.0

// Re-export public API
pub use myproject.types.{ User, Config, Error }
pub use myproject.traits.{ Lifecycle, Observable }
pub use myproject.systems.{ NetworkSystem }

docs {
  My Project library - a DOL specification for [purpose].
  This mod re-exports the public API.
}
```

### types/mod.dol

```dol
mod myproject.types @ 1.0.0

pub use myproject.types.core.{ User, Config }
pub use myproject.types.errors.{ Error, ValidationError }

docs {
  Type definitions for myproject.
}
```

## Evolution and Versioning

DOL tracks how specifications change over time:

```dol
evolves container.lifecycle @0.0.2 from @0.0.1 {
  // Added new state
  add container is pausing

  // Renamed field
  rename status to state

  // Changed type
  change timeout: i32 to timeout: i64
}

docs {
  Evolution from v0.0.1 to v0.0.2 of the container lifecycle.
  Added pausing state for graceful pause support.
  Renamed status to state for clarity.
  Changed timeout to 64-bit for longer durations.
}
```

### Evolution Commands

| Command | Description |
|---------|-------------|
| `add field has property` | Add new property |
| `remove field` | Remove property |
| `rename old to new` | Rename property |
| `change field: OldType to field: NewType` | Change type |

## Visibility Modifiers

DOL has several visibility levels:

| Modifier | Visibility |
|----------|------------|
| (none) | Private to module |
| `pub` | Public everywhere |
| `pub(crate)` | Public within package |
| `pub(super)` | Public to parent module |

```dol
mod myproject.internal @ 1.0.0

// Private - only this mod
gen PrivateHelper {
  has data: string
}

// Public to parent module only
pub(super) gen ParentVisible {
  has value: i64
}

// Public within package
pub(crate) gen PackageVisible {
  has config: Config
}

// Fully public
pub gen PublicAPI {
  has result: Result<Data, Error>
}
```

## Best Practices

### 1. One Concept Per Module

```dol
// Good: focused modules
mod myproject.user @ 1.0.0
mod myproject.auth @ 1.0.0
mod myproject.session @ 1.0.0

// Avoid: catch-all modules
mod myproject.misc @ 1.0.0  // Too vague
```

### 2. Minimize Public API

```dol
mod myproject.auth @ 1.0.0

// Only expose what users need
pub gen Session {
  has token: string
  has expires_at: u64
}

pub fun authenticate(credentials: Credentials) -> Result<Session, AuthError>

// Keep implementation private
gen TokenCache {
  has entries: Map<string, Session>
}

fun validate_token(token: string) -> Bool {
  // internal logic
}
```

### 3. Version Meaningfully

```dol
// Major: Breaking changes
mod myproject @ 2.0.0  // Incompatible API changes

// Minor: New features
mod myproject @ 1.1.0  // Added new genes/functions

// Patch: Bug fixes
mod myproject @ 1.0.1  // Fixed behavior, no API changes
```

## Key Takeaways

- Declare modules with `mod path.name @ version`
- Import with `use module.path.{ Items }`
- Use `pub` for public visibility
- Systems declare dependencies with `requires name >= version`
- Organize projects with clear module boundaries
- Track changes with `evolves` declarations
- Follow semver for versioning

## Practice Exercise

Create a module structure for a blog system:

```dol
mod blog @ 1.0.0

use blog.types.{ Post, Author, Comment }
use blog.traits.{ Publishable, Commentable }

docs {
  Blog system module. Re-exports public API.
}

// In blog/types.dol:
mod blog.types @ 1.0.0

pub gen Post {
  has id: u64
  has title: string
  has content: string
  has author_id: u64
  has published_at: Option<Ui64>
  has tags<Vec<string>

  docs {
    A blog post with optional publication date.
  }
}

pub gen Author {
  // Add fields: id, name, email, bio
}

pub gen Comment {
  // Add fields: id, post_id, author_id, content, created_at
}

// In blog/traits.dol:
mod blog.traits @ 1.0.0

use blog.types.{ Post }

pub trait Publishable {
  uses Post

  post is draft
  post is published
  post is archived

  // Add transitions and constraints
}

docs {
  // Your explanation
}
```

## Congratulations!

You have completed the DOL Fundamentals track! You now understand:

- Genes and the `has` predicate
- Values, types, and enums
- Functions with `fun` keyword
- Control flow and pattern matching
- Collections: List, Map, Option
- Traits and constraints
- Error handling with Result
- Modules and imports

## What's Next?

Continue your DOL journey:

- **[DOL Reference](/dol/reference)** - Complete language specification
- **[Metal DOL](/dol/language)** - The simple ontology syntax
- **[Examples](/dol/examples)** - Real-world specifications
- **[Grammar](/dol/grammar)** - Formal EBNF grammar

<div className="mt-8 flex justify-between">
  <a href="/dol/tutorials/007-error-handling" className="btn-secondary inline-flex items-center gap-2">← Previous: Error Handling</a>
  <a href="/dol/reference" className="btn-primary inline-flex items-center gap-2">Explore the Reference →</a>
</div>
